server:
  port: ${SERVER_PORT:8080}
  servlet:
    context-path: /api/v1

spring:
  application:
    name: planificador
  
  datasource:
    url: ${DATABASE_URL:jdbc:postgresql://localhost:5432/planificador_db}
    username: ${DATABASE_USERNAME:postgres}
    password: ${DATABASE_PASSWORD:1234}
    driver-class-name: org.postgresql.Driver
    
    hikari:
      maximum-pool-size: ${HIKARI_MAX_POOL_SIZE:10}
      minimum-idle: ${HIKARI_MIN_IDLE:5}
      connection-timeout: ${HIKARI_CONNECTION_TIMEOUT:30000}
      idle-timeout: ${HIKARI_IDLE_TIMEOUT:600000}
      max-lifetime: ${HIKARI_MAX_LIFETIME:1800000}
  
  jpa:
    hibernate:
      ddl-auto: ${JPA_DDL_AUTO:update}
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        jdbc:
          batch_size: ${HIBERNATE_BATCH_SIZE:20}
        order_inserts: true
        order_updates: true
    open-in-view: false
  
  main:
    banner-mode: off
  
  mvc:
    throw-exception-if-no-handler-found: true

  web:
    resources:
      add-mappings: false
  
  ldap:
    urls: ${LDAP_URL:ldap://localhost:389}
    base: ${LDAP_BASE:dc=utec,dc=edu,dc=uy}
    username: ${LDAP_MANAGER_DN:}
    password: ${LDAP_MANAGER_PASSWORD:}

management:
  endpoints:
    web:
      base-path: /actuator
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: when-authorized
      show-components: always
      probes:
        enabled: true
  health:
    db:
      enabled: true
    ldap:
      enabled: false
    diskspace:
      enabled: true

springdoc:
  api-docs:
    path: /api-docs
    enabled: true
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    tags-sorter: alpha
    operations-sorter: alpha
    display-request-duration: true
    disable-swagger-default-url: true
  show-actuator: false
  default-consumes-media-type: application/json
  default-produces-media-type: application/json

security:
  jwt:
    secret: ${JWT_SECRET:VXRlY1BsYW5pZmljYWRvckRvY2VudGVTZWNyZXRLZXlGb3JKV1RBdXRoZW50aWNhdGlvbjIwMjVVcnVndWF5VGVjaG5vbG9naWNhbFVuaXZlcnNpdHk=}
    expiration: ${JWT_EXPIRATION:86400000}
    issuer: ${JWT_ISSUER:UTEC-Planificador}
  
  encryption:
    secret: ${ENCRYPTION_SECRET:VXRlY1BsYW5pZmljYWRvckVuY3J5cHRpb25TZWNyZXRLZXkyMDI1VXJ1Z3VheVRlY2hub2xvZ2ljYWxVbml2ZXJzaXR5QUVTMjU2R0NN}

  cookie:
    secure: ${COOKIE_SECURE:false}  # true en producci√≥n (solo HTTPS)
    domain: ${COOKIE_DOMAIN:}

  cors:
    allowed-origins: ${CORS_ALLOWED_ORIGINS:http://localhost:4200}
  
  auth:
    default-provider: ${AUTH_DEFAULT_PROVIDER:LOCAL}
  
  ldap:
    enabled: ${LDAP_ENABLED:false}
    url: ${LDAP_URL:ldap://localhost:389}
    base: ${LDAP_BASE:dc=utec,dc=edu,dc=uy}
    user-base: ${LDAP_USER_BASE:ou=people}
    user-dn-pattern: ${LDAP_USER_DN_PATTERN:uid={0},ou=people}
    user-search-filter: ${LDAP_USER_SEARCH_FILTER:(uid={0})}
    default-role: ${LDAP_DEFAULT_ROLE:TEACHER}
    default-campus-id: ${LDAP_DEFAULT_CAMPUS_ID:1}
    manager:
      dn: ${LDAP_MANAGER_DN:}
      password: ${LDAP_MANAGER_PASSWORD:}

ai:
  agent:
    base-url: ${AI_AGENT_BASE_URL:http://localhost:8000}
    connect-timeout: ${AI_AGENT_CONNECT_TIMEOUT:10000}
    read-timeout: ${AI_AGENT_READ_TIMEOUT:30000}

logging:
  level:
    root: ${LOG_LEVEL:INFO}
    edu.utec.planificador: ${LOG_LEVEL:INFO}
    edu.utec.planificador.security: ${LOG_SECURITY_LEVEL:INFO}
    org.springframework.security: ${LOG_SPRING_SECURITY:WARN}
    org.springframework.ldap: ${LOG_LDAP:WARN}
    org.springframework.security.crypto.password: ERROR
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: ${LOG_FILE:logs/application.log}
    max-size: 10MB
    max-history: 30
